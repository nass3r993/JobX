{% extends 'base.html' %}
{% block title %}Job Details{% endblock %}

{% block content %}
<style>
  .job-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
    padding: 2rem;
    max-width: 800px;
    margin: 0 auto;
    margin-top: 2rem;
    font-family: 'Inter', sans-serif;
  }

  .job-card h3 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    color: #111827;
  }

  .job-card p.description {
    font-size: 1rem;
    color: #4b5563;
    margin-bottom: 1.5rem;
  }

  .job-card ul {
    list-style: none;
    padding: 0;
    border: none;
    margin: 0 0 1.5rem 0;
    background: transparent;
    box-shadow: none; /* Ensure no shadow */
  }

  .job-card li {
    padding: 0.4rem 0 0.6rem 2rem;
    margin-bottom: 0.25rem;
    font-size: 0.95rem;
    color: #374151;
    position: relative;
    background: transparent;
    border: none;
    box-shadow: none; /* Ensure no shadow */
  }

  .job-card li::before {
    content: '';
    position: absolute;
    top: 0.9rem;
    left: 0.75rem;
    width: 8px;
    height: 8px;
    background-color: #10b981; /* green point */
    border-radius: 50%;
  }

  .apply-btn {
    background-color: #10b981;
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
    display: inline-block;
    transition: background-color 0.3s ease;
  }

  .apply-btn:hover {
    background-color: #059669;
  }

  .page-heading {
    text-align: center;
    margin-top: 2rem;
    font-size: 2rem;
    font-weight: 800;
    color: #111827;
  }
</style>

<h2 class="page-heading">Job Details</h2>

<div class="job-card" id="job-detail">
  <p>Loading job details...</p>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const jobId = "{{ job_id }}";
    fetch(`/api/v1/jobs/${jobId}`)
      .then(response => response.json())
      .then(job => {
        const detailDiv = document.getElementById('job-detail');

        // Parse list from `job.responsibilities` if it exists and is an array
        const responsibilities = Array.isArray(job.responsibilities)
          ? `<ul>${job.responsibilities.map(r => `<li>${r}</li>`).join('')}</ul>`
          : '';

        detailDiv.innerHTML = `
          <h3>${job.title}</h3>
          <p class="description">${job.description}</p>
          ${responsibilities}
          <a class="apply-btn" href="/jobs/${job.id}/apply">Apply Now</a>
        `;
      })
      .catch(error => {
        console.error('Error fetching job details:', error);
        document.getElementById('job-detail').innerHTML = `
          <div class="no-applications">
            <p>Failed to load job details. Please try again later.</p>
          </div>
        `;
      });
  });
</script>
{% endblock %}
